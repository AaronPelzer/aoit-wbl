<% include ../header.ejs %>

<div class="row">
    <div class="col-sm-12 col-md-2 col-lg-2">
        <div class="form-group">
            <label for="tbDate">Date</label>
            <input class="form-control" name="tbDate" type="date" placeholder="01/01/2001" required />
        </div>
    </div>

    <div class="col-sm-12 col-md-2 col-lg-2">
        <div class="form-group">
            <label for="ddlWblType">Work Based Learning</label>
            <select class="form-control" name="ddlWblType" required>
                <option></option>
                <% for(var i = 0; i < results.wblType.length; i++) { %>
                    <option value="<%= results.wblType[i].ID %>"> <%= results.wblType[i].type %> </option>
                <% } %>
            </select>
        </div>
    </div>
    

    <div class="col-sm-12 col-md-4 col-lg-3">
        <div class="form-group">
            <label for="tbOrg">Organization</label>
            <input class="form-control" name="tbOrg" type="text" placeholder="" required />
        </div>
    </div>


    <div class="col-sm-12 col-md-2 col-lg-2">
        <div class="form-group">
            <label for="tbHours">Hours</label>
            <input class="form-control" name="tbHours" type="text" placeholder="" required />
        </div>
    </div>

</div>


<div class="row">
    <div class="col-sm-12 col-md-9 col-lg-9">
        <div class="form-group">
            <label for="tbComment">Comment(s)</label>
            <textarea class="form-control" name="tbComment" type="text" placeholder=""></textarea>
        </div>
    </div>

    <div class="col-sm-12 col-md-1 col-lg-1">
        <div class="form-group">
            <button class="btn btn-default btnAdd">+</button>
        </div>
    </div>
</div>

<div class="row">
    <div class="list-group col-xs-12 col-sm-12 col-md-10 col-lg-10">
        <% for(var a in results.wblActivities){ %>        
            <a href="courses/<%= results.wblActivities[a].ID %>/update" class="list-group-item list-group-item-action">
                <%= results.wblActivities[a].organization %>
            </a>
        <% } %>
    </div>
</div>

    <div class="dvEntered">

    </div>
    <br /><br />
    <div class="row">
        <div class="col-sm-12 col-md-12 col-lg-12">
            <button class="btn btn-default">Back</button>
            <div class="pull-right">
                <button class="btn btn-default" id="save">Save</button>
                <button class="btn btn-default">Next</button>
            </div>
        </div>
    </div>

<script src="/js/utilities.js"></script>
<script>

    var row = 0,
        activities = [];

    function reset(args){

        args.forEach(function(elem){
            if(el(elem).type === "text"){
                el(elem).value = "";
            } else if(el(elem).type === "select-one"){
                var e = el(elem);
                e.selectedIndex = 0;
            }
        });
    }

    function getNames(){
        var names = el("[name]", 1);
        names.forEach((itm) => {
            console.log(itm.getAttribute("name"));
        });
    }

    addListener(".btnAdd", "click", function(){
        var html = "";

        addNewItem(["[name=tbDate]", "[name=ddlWblType]", "[name=tbOrg]", "[name=tbHours]", "[name=tbComment]"], { 
            date: "", wblType: 0, org: "", hours: 0, comment: "" 
            }, activities);

        var cols = createCol( el("[name=ddlWblType]").options[activities[ activities.length - 1].wblType].text );

        el(".dvEntered").insertAdjacentHTML("beforeEnd", createRow(cols));    
    });

    addListener("#save", "click", () => {
        let xhr = new XMLHttpRequest();
        xhr.open("POST", "newActivity", true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify(activities));
    })
</script>

<% include ../footer.ejs %>